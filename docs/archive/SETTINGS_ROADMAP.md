# BetterFriendlist Settings System - Roadmap

## Overview
This document outlines the complete settings system for BetterFriendlist, including all planned features and implementation phases.

---

## ğŸ¯ Settings Categories

### 1. Visual Settings (Visuelle Einstellungen)
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Custom Group Colors** | Allow users to customize colors for each group (including Favorites/No Groups) | High | âœ… Implemented | BFL |
| **Custom Group Icons** | Choose from various icons for custom groups | Medium | ğŸ“‹ Planned | - |
| **Font Size** | Small/Normal/Large options for names and status text | Medium | âœ… Implemented | BFL |
| **Compact Mode** | Smaller buttons to fit more friends on screen | High | âœ… Implemented | BFL |
| **Window Transparency** | Adjust background transparency of the frame | Low | ğŸ“‹ Planned | - |
| **Theme Support** | Light/Dark theme options | Low | ğŸ“‹ Planned | - |
| **Show Faction Icons** | Display faction icons (Alliance/Horde) for friends | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Show Realm Name** | Display realm name for cross-realm friends | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Colour Class Names** | Color character names by class | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Gray Out Other Faction** | Display opposite faction friends in gray | Low | ğŸ“‹ Planned | FG âœ¨ |
| **Hide Max Level** | Don't show level for max-level characters | Low | ğŸ“‹ Planned | FG âœ¨ |
| **Show Only BattleTag** | Display only BattleTag instead of character names | Low | ğŸ“‹ Planned | FG âœ¨ |

### 2. Group Management (Gruppen-Verwaltung)
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Group Order (Drag & Drop)** | Reorder all groups including Favorites and No Groups | Critical | âœ… Implemented | BFL |
| **Custom Group Colors** | Allow users to customize colors for each group (including Favorites/No Groups) | High | âœ… Implemented | BFL |
| **Default Group for New Friends** | Automatically assign new friends to a specific group | Medium | ğŸ“‹ Planned | - |
| **Hide Groups** | Temporarily hide groups without deleting them | Low | ğŸ“‹ Planned | - |
| **Group Presets** | Save and load group configurations | Low | ğŸ“‹ Planned | - |
| **Hide Empty Groups** | Don't show groups with no online/visible friends | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Open Only One Group** | Auto-collapse other groups when opening a new one | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Enable Favorite Group** | Toggle visibility of Favorites group | Low | ğŸ“‹ Planned | FG âœ¨ |

### 3. Search & Filter Settings (Such- & Filter-Einstellungen)
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Default Sort Order** | Sort by Name, Status, Level, Class, Zone, etc. | High | ğŸ“‹ Planned | - |
| **Save Filter Presets** | Create and save custom filter combinations | Medium | ğŸ“‹ Planned | - |
| **Quick Filter Buttons** | One-click filters: "Online Only", "WoW Only", "BNet Only" | High | ğŸ“‹ Planned | - |
| **Search in Notes** | Toggle whether search includes friend notes | Medium | ğŸ“‹ Planned | - |
| **Case Sensitive Search** | Option for case-sensitive search | Low | ğŸ“‹ Planned | - |
| **Enable Search** | Toggle search functionality visibility | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Hide All Offline** | Filter to hide all offline friends | High | ğŸ“‹ Planned | FG âœ¨ |
| **Hide All AFK** | Filter to hide all AFK friends | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Show Only Ingame Friends** | Filter to show only friends currently in WoW | High | ğŸ“‹ Planned | FG âœ¨ |
| **Show Only Retail Friends** | Filter for Retail vs Classic friends | Medium | ğŸ“‹ Planned | FG âœ¨ |
| **Sort by Status** | Sort friends by online/offline/away status | Medium | ğŸ“‹ Planned | FG âœ¨ |

### 4. Mobile & Status Options
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Show Mobile as AFK** | Display mobile users with AFK status icon | Low | ğŸ“‹ Planned | FG âœ¨ |
| **Add Mobile Text** | Add "(Mobile)" text to mobile users | Low | ğŸ“‹ Planned | FG âœ¨ |

### 5. Notifications (Benachrichtigungen)
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Login Notifications** | Select which groups/friends trigger notifications | Medium | ğŸ“‹ Planned | - |
| **Sound Effects** | Enable/disable sounds for various events | Medium | ğŸ“‹ Planned | - |
| **Chat Message Format** | Customize login/logout message format | Low | ğŸ“‹ Planned | - |
| **Notification Position** | Choose where notifications appear on screen | Low | ğŸ“‹ Planned | - |
| **VIP Friends** | Special notifications for specific friends | Medium | ğŸ“‹ Planned | - |

### 6. Performance & Behavior (Performance & Verhalten)
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Show Blizzard Friendlist Option** | Toggle visibility of "Show Blizzard's Friendlist" menu item | High | âœ… Implemented | BFL |
| **Update Interval** | How often the friend list refreshes | Low | ğŸ“‹ Planned | - |
| **Auto-Open on Login** | Automatically open frame on player login | Low | ğŸ“‹ Planned | - |
| **Minimize Instead of Close** | Alternative close behavior | Low | ğŸ“‹ Planned | - |
| **Remember Position** | Save window position between sessions | Medium | ğŸ“‹ Planned | - |
| **Remember Size** | Allow resizing and save dimensions | Low | ğŸ“‹ Planned | - |

### 7. Quick Actions (Schnellaktionen)
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Custom Context Menu** | Choose which options appear in right-click menu | Medium | ğŸ“‹ Planned | - |
| **Favorite Hotkey** | Keybind to quickly add/remove from favorites | Low | ğŸ“‹ Planned | - |
| **Quick Invite Button** | Direct invite button instead of menu navigation | Medium | ğŸ“‹ Planned | - |
| **Custom Hotkeys** | Assign hotkeys to common actions | Low | ğŸ“‹ Planned | - |
| **Invite All to Party** | Right-click group to invite all members | Medium | ğŸ“‹ Planned | FG âœ¨ |

### 8. Statistics (Statistiken) - Optional
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Playtime with Friends** | Track time spent playing with each friend | Low | ğŸ“‹ Planned | - |
| **Activity Tracking** | Most frequent activities with friends | Low | ğŸ“‹ Planned | - |
| **Online Time Patterns** | When friends are usually online | Low | ğŸ“‹ Planned | - |

### 9. Import/Export (Import/Export)
| Feature | Description | Priority | Status | Source |
|---------|-------------|----------|--------|--------|
| **Export Groups** | Backup/share group configurations | Low | ğŸ“‹ Planned | - |
| **Import Groups** | Import configurations from backup/sharing | Low | ğŸ“‹ Planned | - |
| **Profile System** | Multiple configurations for different characters | Low | ğŸ“‹ Planned | - |
| **Reset to Defaults** | Restore all settings to default values | Medium | ğŸ“‹ Planned | - |

---

## ğŸ“ Legend
- **BFL** = BetterFriendlist (already implemented)
- **FG âœ¨** = Feature from FriendGroups (predecessor addon)
- **-** = Original BetterFriendlist feature concept

---

## ğŸ“ Implementation Plan

### Phase 1: Foundation (Settings Framework)
**Goal:** Create the basic settings window infrastructure

#### Step 1.1: Create Settings Frame
- [ ] Create new file: `BetterFriendlist_Settings.lua`
- [ ] Create new file: `BetterFriendlist_Settings.xml`
- [ ] Add to `.toc` file load order
- [ ] Create main settings frame inheriting from `ButtonFrameTemplate`
- [ ] Add title, close button, and basic layout
- [ ] Add "Settings" button to contacts menu

#### Step 1.2: Database Integration
- [ ] Extend `Modules/Database.lua` with settings defaults
- [ ] Add settings getter/setter methods
- [ ] Add migration system for new settings
- [ ] Create settings validation system

#### Step 1.3: Tab/Category System
- [ ] Implement tab buttons (General, Groups, Appearance, etc.)
- [ ] Create category switching mechanism
- [ ] Add scroll frame for settings content
- [ ] Implement Apply/Cancel/Defaults buttons

**Estimated Time:** 2-3 implementation sessions

---

### Phase 2: Group Management Features (Priority 1)
**Goal:** Implement the most requested feature - group ordering and management

#### Step 2.1: Group Order (Drag & Drop)
- [x] Create draggable group list UI
- [x] Implement drag & drop logic for reordering
- [x] Include Favorites and No Groups in reorderable list
- [x] Save order to database
- [x] Apply order to main friend list display

#### Step 2.2: Custom Group Colors
- [x] Create color picker UI component
- [x] Add color selection for each group
- [x] Save colors to database
- [x] Apply colors to group headers in main list
- [x] Add color preview in settings

**Status:** âœ… Completed

---

### Phase 3: Visual & Display Options (Priority 2)
**Goal:** Add customization for appearance and display

#### Step 3.1: Compact Mode
- [x] Add checkbox for compact mode
- [x] Reduce button height (34px â†’ 24px or similar)
- [x] Adjust font sizes for compact mode
- [x] Save preference to database
- [x] Refresh display when toggled

#### Step 3.2: Font Size Options
- [x] Add radio buttons: Small / Normal / Large
- [x] Create font size multipliers (0.8x / 1.0x / 1.2x)
- [x] Apply to all text elements
- [x] Save preference to database

#### Step 3.3: Blizzard Friendlist Toggle (UI)
- [x] Move `/bfl show/hide/toggle` functionality to settings UI
- [x] Add checkbox: "Show 'Blizzard Friendlist' in menu"
- [x] Remove need for slash commands (keep them for backwards compatibility)
- [x] Update tooltip/help text

**Status:** âœ… Completed
**Estimated Time:** 2-3 implementation sessions

---

### Phase 4: Search & Filter Enhancements (Priority 2)
**Goal:** Improve search and filtering capabilities

#### Step 4.1: Quick Filter Buttons
- [x] Add filter button bar to main friend list
- [x] Implement "Online Only" filter
- [x] Implement "WoW Only" filter
- [x] Implement "BNet Only" filter
- [x] Save active filters to session (not persistent)

**Status:** âœ… Completed

#### Step 4.2: Default Sort Order
- [ ] Add dropdown for sort order in settings
- [ ] Options: Name, Status, Level, Class, Zone, Last Online
- [ ] Implement sort comparators
- [ ] Save preference to database
- [ ] Apply on friend list display
- [ ] Remove SORT tab when dropdown is implemented successfully

#### Step 4.3: Search Settings
- [ ] Add checkbox: "Search in Notes"
- [ ] Add checkbox: "Case Sensitive Search"
- [ ] Update search function to respect settings
- [ ] Save preferences to database

**Estimated Time:** 2-3 implementation sessions

---

### Phase 5: Behavior & Usability (Priority 3)
**Goal:** Add quality of life features

#### Step 5.1: Window Behavior
- [ ] Add checkbox: "Remember Window Position"
- [ ] Save position to database on close
- [ ] Restore position on open
- [ ] Add checkbox: "Auto-Open on Login"
- [ ] Implement auto-open logic

#### Step 5.2: Performance Settings
- [ ] Add slider: "Update Interval" (1-10 seconds)
- [ ] Implement throttled update system
- [ ] Save preference to database
- [ ] Display current interval in settings

#### Step 5.3: Default Group Assignment
- [ ] Add dropdown: "Default Group for New Friends"
- [ ] Options: Favorites, No Group, or any custom group
- [ ] Implement auto-assignment on friend add
- [ ] Save preference to database

**Estimated Time:** 2 implementation sessions

---

### Phase 6: Notifications (Priority 3)
**Goal:** Add notification system

#### Step 6.1: Basic Notifications
- [ ] Create notification frame/toast system
- [ ] Add checkbox: "Enable Login Notifications"
- [ ] Add checkbox: "Enable Logout Notifications"
- [ ] Add checkbox: "Enable Sound Effects"
- [ ] Implement notification display

#### Step 6.2: Advanced Notifications
- [ ] Add per-group notification settings
- [ ] Add "VIP Friends" list for special notifications
- [ ] Add notification position selector
- [ ] Add sound selection dropdown

**Estimated Time:** 2-3 implementation sessions

---

### Phase 7: Advanced Features (Priority 4 - Optional)
**Goal:** Add power-user features

#### Step 7.1: Custom Context Menu
- [ ] Add checklist of context menu options
- [ ] Allow enabling/disabling menu items
- [ ] Reorder menu items
- [ ] Save configuration to database

#### Step 7.2: Statistics (Optional)
- [ ] Track playtime with friends
- [ ] Display statistics in separate tab
- [ ] Add reset statistics button
- [ ] Visualize data with simple charts

#### Step 7.3: Import/Export
- [ ] Add "Export Configuration" button
- [ ] Generate exportable string
- [ ] Add "Import Configuration" text box
- [ ] Parse and validate import string
- [ ] Add "Reset All Settings" button with confirmation

**Estimated Time:** 3-4 implementation sessions

---

## ğŸ¨ UI Design Concept

### Settings Window Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BetterFriendlist Settings            [X]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  [General] [Groups] [Appearance] [Advanced]    â”‚ â† Tabs
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                          â”‚ â”‚
â”‚  â”‚  Settings Content Area                  â”‚ â”‚
â”‚  â”‚  (Scrollable)                           â”‚ â”‚
â”‚  â”‚                                          â”‚ â”‚
â”‚  â”‚  [ ] Option 1                           â”‚ â”‚
â”‚  â”‚  [ ] Option 2                           â”‚ â”‚
â”‚  â”‚  [Dropdown Menu â–¼]                      â”‚ â”‚
â”‚  â”‚  [Color Picker]                         â”‚ â”‚
â”‚  â”‚                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                 â”‚
â”‚     [Apply]  [Cancel]  [Defaults]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Group Order Settings (Drag & Drop)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Group Order                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  Drag groups to reorder:        â”‚
â”‚                                 â”‚
â”‚  â‰¡ Favorites             â†•      â”‚
â”‚  â‰¡ Guild Members         â†•      â”‚
â”‚  â‰¡ IRL Friends           â†•      â”‚
â”‚  â‰¡ Raid Team             â†•      â”‚
â”‚  â‰¡ No Group              â†•      â”‚
â”‚                                 â”‚
â”‚  [Reset to Default Order]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Technical Architecture

### File Structure
```
BetterFriendlist/
â”œâ”€â”€ Core.lua
â”œâ”€â”€ BetterFriendlist.lua
â”œâ”€â”€ BetterFriendlist.xml
â”œâ”€â”€ BetterFriendlist.toc
â”œâ”€â”€ BetterFriendlist_Settings.lua      â† NEW
â”œâ”€â”€ BetterFriendlist_Settings.xml      â† NEW
â”œâ”€â”€ BetterFriendlist_Tooltip.lua
â””â”€â”€ Modules/
    â”œâ”€â”€ Database.lua                    â† EXTEND
    â”œâ”€â”€ Groups.lua
    â””â”€â”€ Settings.lua                    â† NEW (optional module)
```

### Database Schema Extension
```lua
BetterFriendlistDB = {
    -- Existing
    groupStates = {},
    customGroups = {},
    friendGroups = {},
    version = "0.1",
    
    -- New Settings
    settings = {
        -- Visual
        compactMode = false,
        fontSize = "normal", -- "small", "normal", "large"
        transparency = 1.0,
        
        -- Groups
        groupOrder = {"favorites", "group1", "group2", "nogroup"},
        autoCollapseGroups = {},
        defaultGroupForNewFriends = "nogroup",
        groupColors = {},
        
        -- Behavior
        showBlizzardOption = false, -- EXISTING, move here
        rememberPosition = true,
        windowPosition = {x = 0, y = 0},
        autoOpenOnLogin = false,
        updateInterval = 3,
        
        -- Search/Filter
        defaultSortOrder = "name",
        searchInNotes = true,
        caseSensitiveSearch = false,
        
        -- Notifications
        enableLoginNotifications = true,
        enableLogoutNotifications = false,
        enableSounds = true,
        vipFriends = {},
        
        -- Advanced
        customContextMenu = {},
    }
}
```

---

## ğŸ“ Implementation Notes

### Coding Standards
1. Use modular approach - each settings category in its own function
2. Follow existing WoW UI patterns (like Interface Options)
3. All settings changes should be validated before saving
4. Provide clear user feedback for actions (success/error messages)
5. Use localization-ready strings (even if English-only initially)

### Testing Checklist (per feature)
- [ ] Settings save correctly to database
- [ ] Settings load correctly on login
- [ ] Settings apply immediately or on next reload (document which)
- [ ] Default values work correctly
- [ ] Reset to defaults works
- [ ] No Lua errors in error addons (BugSack/BugGrabber)
- [ ] UI elements are properly aligned
- [ ] Tooltips explain what each setting does

### Performance Considerations
- Use throttling for frequently updated settings (like update interval)
- Don't refresh entire friend list unless necessary
- Cache settings values locally when accessed frequently
- Use efficient data structures for drag & drop

---

## ğŸš€ Getting Started

### Next Immediate Steps:
1. Create `BetterFriendlist_Settings.lua` with basic frame structure
2. Create `BetterFriendlist_Settings.xml` with frame definition
3. Add "Settings" button to contacts menu
4. Implement Phase 1 (Foundation)

### Development Order Rationale:
- **Phase 1** is required for everything else
- **Phase 2** addresses most user-requested features
- **Phase 3** improves visual appeal and usability
- **Phase 4-7** are enhancements that can be added incrementally

---

## ğŸ“Š Priority Summary

### Must Have (Phase 1-3) âœ… COMPLETED
- Settings window framework
- Group ordering (drag & drop)
- Group colors
- Compact mode
- Font size options

### Should Have (Phase 4-5) - Next Priority
- Quick filters (Online Only, Ingame Only, Hide Offline, Hide AFK)
- Sort order options (by status, by name)
- Hide empty groups
- Show faction icons
- Colour class names
- Show realm names

### Nice to Have (Phase 6-7)
- Window position memory
- Notifications system
- Performance settings
- Gray out other faction
- Show only BattleTag
- Hide max level
- Mobile customization (show as AFK, add text)

### Optional (Phase 8+)
- Statistics
- Import/Export
- Custom context menus
- Advanced power-user features
- Profile system
- Open only one group at a time

---

## ğŸ¯ FriendGroups Feature Summary

The predecessor addon **FriendGroups** had the following features that inspired this roadmap:

**Filter Options:**
- Enable Search
- Hide all offline
- Hide all AFK
- Hide empty groups
- Show only Ingame Friends
- Show only Retail Friends

**Customize Options:**
- Show Faction Icons
- Show Realm
- Colour names (by class)
- Gray out other Faction
- Show Mobile always as AFK
- Add Mobile Text
- Hide level of max level players
- Show only BattleTag
- Enable Favorite Friends Group

**Sort Options:**
- Sort by status

**Misc Options:**
- Enable to open only one group at a time

**Quick Actions:**
- Invite all to party (from group context menu)
- Rename group
- Remove group

These features have been integrated into the roadmap above with the marker **FG âœ¨**.

---

## ğŸ“… Estimated Timeline

- **Phase 1:** 2-3 sessions âœ… COMPLETED
- **Phase 2:** 3-4 sessions âœ… COMPLETED
- **Phase 3:** 2-3 sessions âœ… COMPLETED
- **Phase 4:** 2-3 sessions (FriendGroups-inspired filters)
- **Phase 5:** 2-3 sessions (Visual customization from FG)
- **Phase 6:** 2 sessions (Behavior settings)
- **Phase 7:** 2-3 sessions (Notifications)
- **Phase 8+:** 3-4 sessions (optional advanced features)

**Total:** ~16-24 implementation sessions for full feature set
**Core Features (Phase 1-3):** âœ… COMPLETED (~10 sessions)
**Remaining:** ~6-14 sessions for enhanced features

---

*Last Updated: 2025-10-28*
*Status: Phase 3 Complete - Enhanced with FriendGroups features*
